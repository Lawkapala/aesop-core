jQuery(document).ready(function($){$(".aesop-generator").dropkick({change:function(){var e=$("#aesop-generator-select").find(":selected").val();$("#aesop-generator-settings").html(aesopshortcodes[e])}}),$("#aesop-generator-insert,.aesop-generator").live("click",function(){$(".aesop-generator-empty").hide();var e=$(".aesop-generator").find(":selected").val(),t=$("#aesop-compatibility-mode-prefix").val();$("#aesop-generator-result").val("["+t+e),$("#aesop-generator-settings .aesop-generator-attr").each(function(){""!==$(this).val()&&$("#aesop-generator-result").val($("#aesop-generator-result").val()+" "+$(this).attr("name")+'="'+$(this).val()+'"')}),$("#aesop-generator-result").val($("#aesop-generator-result").val()+"]"),"false"!=$("#aesop-generator-content").val()&&$("#aesop-generator-result").val($("#aesop-generator-result").val()+$("#aesop-generator-content").val()+"[/"+t+e+"]");var a=tinyMCE.activeEditor.dom.select("#aesop-generator-editing");return tinyMCE.activeEditor.dom.remove(a),window.send_to_editor(jQuery("#aesop-generator-result").val()),!1})});var file_frame;jQuery("#aesop-upload-img").live("click",function(e){return e.preventDefault(),file_frame?void file_frame.open():(file_frame=wp.media.frames.file_frame=wp.media({title:jQuery(this).data("uploader_title"),button:{text:jQuery(this).data("uploader_button_text")},multiple:!1}),file_frame.on("select",function(){attachment=file_frame.state().get("selection").first().toJSON(),jQuery("#aesop-generator-attr-img,#aesop-generator-attr-src, #aesop-generator-attr-hosted").val(attachment.url)}),void file_frame.open())}),function($,e,t){function a(e,t){var a=e.keyCode,o=t.data("dropkick"),s=t.find(".dk_options"),d=t.hasClass("dk_open"),c=t.find(".dk_option_current"),p=s.find("li").first(),u=s.find("li").last(),k,v;switch(a){case f.enter:d?(n(c.find("a"),t),i(t)):l(t),e.preventDefault();break;case f.up:v=c.prev("li"),d?v.length?r(v,t):r(u,t):l(t),e.preventDefault();break;case f.down:d?(k=c.next("li").first(),k.length?r(k,t):r(p,t)):l(t),e.preventDefault()}}function n(e,t,a){var n,r,o;n=e.attr("data-dk-dropdown-value"),r=e.text(),o=t.data("dropkick"),$select=o.$select,$select.val(n),t.find(".dk_label").text(r),a=a||!1,o.settings.change&&!a&&o.settings.change.call($select,n,r)}function r(e,t){t.find(".dk_option_current").removeClass("dk_option_current"),e.addClass("dk_option_current"),o(t,e)}function o(e,t){var a=t.prevAll("li").outerHeight()*t.prevAll("li").length;e.find(".dk_options_inner").animate({scrollTop:a+"px"},0)}function i(e){e.removeClass("dk_open")}function l(e){var t=e.data("dropkick");e.find(".dk_options").css({top:e.find(".dk_toggle").outerHeight()-1}),e.toggleClass("dk_open")}function s(e,t){var a=e,n=[],r;if(a=a.replace("{{ id }}",t.id),a=a.replace("{{ label }}",t.label),a=a.replace("{{ tabindex }}",t.tabindex),t.options&&t.options.length)for(var o=0,i=t.options.length;i>o;o++){var l=$(t.options[o]),s="dk_option_current",c=v;c=c.replace("{{ classvalue }}",l.val()),c=c.replace("{{ value }}",l.val()),c=c.replace("{{ current }}",d(l.val())===t.value?s:""),c=c.replace("{{ text }}",l.text()),n[n.length]=c}return r=$(a),r.find(".dk_options_inner").html(n.join("")),r}function d(e){return $.trim(e).length>0?e:!1}var c=!1;$.browser.msie&&$.browser.version.substr(0,1)<7?c=!0:t.documentElement.className=t.documentElement.className+" dk_fouc";var p={},u=[],f={left:37,up:38,right:39,down:40,enter:13},k=['<div class="dk_container" id="dk_container_{{ id }}" tabindex="{{ tabindex }}">','<a class="dk_toggle">','<span class="dk_label">{{ label }}</span>',"</a>",'<div class="dk_options">','<ul class="dk_options_inner">',"</ul>","</div>","</div>"].join(""),v='<li class="{{ current }} {{ classvalue }}"><a data-dk-dropdown-value="{{ value }}">{{ text }}</a></li>',_={startSpeed:1e3,theme:!1,change:!1},g=!1;p.init=function(e){return e=$.extend({},_,e),this.each(function(){var t=$(this),a=t.find(":selected").first(),n=t.find("option"),r=t.data("dropkick")||{},o=t.attr("id")||t.attr("name"),i=e.width||t.outerWidth(),l=t.attr("tabindex")?t.attr("tabindex"):"",c=!1,p;return r.id?t:(r.settings=e,r.tabindex=l,r.id=o,r.$original=a,r.$select=t,r.value=d(t.val())||d(a.attr("value")),r.label=a.text(),r.options=n,c=s(k,r),c.find(".dk_toggle").css({width:i+"px"}),t.before(c),c=$("#dk_container_"+o).fadeIn(e.startSpeed),p=e.theme?e.theme:"default",c.addClass("dk_theme_"+p),r.theme=p,r.$dk=c,t.data("dropkick",r),c.data("dropkick",r),u[u.length]=t,c.bind("focus.dropkick",function(e){c.addClass("dk_focus")}).bind("blur.dropkick",function(e){c.removeClass("dk_open dk_focus")}),void setTimeout(function(){t.hide()},0))})},p.theme=function(e){var t=$(this),a=t.data("dropkick"),n=a.$dk,r="dk_theme_"+a.theme;n.removeClass(r).addClass("dk_theme_"+e),a.theme=e},p.reset=function(){for(var e=0,t=u.length;t>e;e++){var a=u[e].data("dropkick"),o=a.$dk,i=o.find("li").first();o.find(".dk_label").text(a.label),o.find(".dk_options_inner").animate({scrollTop:0},0),r(i,o),n(i,o,!0)}},$.fn.dropkick=function(e){if(!c){if(p[e])return p[e].apply(this,Array.prototype.slice.call(arguments,1));if("object"==typeof e||!e)return p.init.apply(this,arguments)}},$(function(){$(".dk_toggle").live("click",function(t){var a=$(this).parents(".dk_container").first();return l(a),"ontouchstart"in e&&(a.addClass("dk_touch"),a.find(".dk_options_inner").addClass("scrollable vertical")),t.preventDefault(),!1}),$(".dk_options a").live($.browser.msie?"mousedown":"click",function(e){var t=$(this),a=t.parents(".dk_container").first(),o=a.data("dropkick");return i(a),n(t,a),r(t.parent(),a),e.preventDefault(),!1}),$(t).bind("keydown.dk_nav",function(e){var t=$(".dk_container.dk_open"),n=$(".dk_container.dk_focus"),r=null;t.length?r=t:n.length&&!t.length&&(r=n),r&&a(e,r)})})}(jQuery,window,document);