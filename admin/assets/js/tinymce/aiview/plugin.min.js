tinymce.PluginManager.add("aiview",function(e){function o(e){return e.replace(/(\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]|\[aesop_([a-zA-Z]+)\s?([^\[\]]*)])/g,function(e){return a("aesop-component",e)})}function a(e,o){var a=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,t=/\[aesop_([a-zA-Z]+)\s?([^\[\]]*)]/g,n=a.exec(o);if(n)var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem '+e+'"><div class="aesop-component-bar"><div class="aesop-component-controls"><div class="aesop-button aesop-button-delete">&nbsp;</div><div class="aesop-button aesop-button-edit aesop-scope-'+n[1]+'">&nbsp;</div></div><span class="mceNonEditable aesop-component-title aesop-'+n[1]+'-title">'+n[1]+'</span></div><div class="aesop-component-content aesop-'+n[1]+'">'+n[3]+"</div></div>";else{n=t.exec(o);var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem '+e+'"><div class="aesop-component-bar"><div class="aesop-component-controls mceNonEditable"><div class="aesop-button aesop-button-delete">&nbsp;</div><div class="aesop-button aesop-button-edit aesop-scope-'+n[1]+'">&nbsp;</div></div><span class="mceNonEditable aesop-component-title aesop-'+n[1]+'-title">'+n[1]+'</span></div><div class="aesop-end">WcMgcq</div></div>'}return s}function t(e){return e.replace(/<div.*?class="[^"]+aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>|<div class="[^"]+aesop-component.*aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,function(e){return n(e)})}function n(e){var o=/<div.*?class="[^"]+aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>/g,a=/<div class="[^"]+aesop-component.*aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,t=o.exec(e);if(t){sc=window.decodeURIComponent(t[1]);var n=/\[[^\]]*\]([^\[]*)[^\]]*\]/,s=n.exec(sc);return sc=sc.replace(s[1],t[2])}return(t=a.exec(e))?sc=window.decodeURIComponent(t[1]):e}function s(e){var o=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,a=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]/g,t=/<br data-mce-bogus="1">/g,n=/([^\s]+)\s?/g,s=o.exec(e);if(!s&&(s=a.exec(e),!s))return match;var c=s[2].split(" ");return ai_map=[],c.forEach(function(e){e=e.split("="),attr_key=e[0],attr_value=e[1],attr_value=attr_value.slice(0,-1),ai_map[attr_key]=attr_value.substring(1)}),"undefined"!=typeof s[3]&&(ai_map.content=s[3].replace(t,"")),ai_map}e.onClick.add(function(e,o){if(o.target.className.indexOf("aesop-button-delete")>-1){var a=confirm("Are you sure you want to delete this Aesop Component?");1==a&&o.target.parentNode.parentNode.parentNode.parentNode.removeChild(o.target.parentNode.parentNode.parentNode)}if(o.target.className.indexOf("aesop-button-edit")>-1){var n=/aesop-scope-([a-z]*)/,c=n.exec(o.target.className),p=o.target.parentNode.parentNode.parentNode,i=t(p.outerHTML);if(p.setAttribute("id","aesop-generator-editing"),c){window.jQuery("body").toggleClass("modal-open"),window.jQuery("#aesop-generator-wrap").toggleClass("aesop-generator-open");var r=".dk_options li."+c[1]+" a";window.jQuery(r).click();var d=s(i);for(var l in d)"content"==l?window.jQuery("#aesop-generator-content").val(d[l]):window.jQuery('#aesop-generator-settings [name="'+l+'"]').val(d[l])}}}),e.onKeyDown.add(function(e,o){if(13==o.keyCode&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){var a=e.selection.getNode(),t=window.jQuery(a).parents(".aesop-component");if(window.jQuery(a).parents(".aesop-component")[0]){o.preventDefault(),o.stopPropagation();var n=window.jQuery("<p><br/></p>").insertAfter(t);n.uniqueId();var s=n.attr("id"),c=e.dom.select("#"+s)[0];e.selection.setCursorLocation(c)}}}),e.on("BeforeSetContent",function(e){e.content=o(e.content)}),e.on("PostProcess",function(e){e.get&&(e.content=t(e.content))})});
//# sourceMappingURL=./plugin.min.map