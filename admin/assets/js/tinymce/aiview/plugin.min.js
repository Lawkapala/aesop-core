!function($){tinymce.PluginManager.add("aiview",function(e){function o(e){return e.replace(/(\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]|\[aesop_([a-zA-Z]+)\s?([^\[\]]*)])/g,function(e){return t("aesop-component",e)})}function t(e,o){var t=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,a=/\[aesop_([a-zA-Z]+)\s?([^\[\]]*)]/g,n=t.exec(o);if(n)var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem '+e+'"><div class="aesop-component-bar"><div class="aesop-component-controls"><div class="aesop-button aesop-button-delete">&nbsp;</div><div class="aesop-button aesop-button-edit aesop-scope-'+n[1]+'">&nbsp;</div><div class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+n[1]+'-title">'+n[1]+'</span></div><div class="aesop-component-content aesop-'+n[1]+'">'+n[3]+"</div></div>";else{n=a.exec(o);var s='<div data-mce-resize="false" data-mce-placeholder="1" data-aesop-sc="'+window.encodeURIComponent(o)+'" class="mceItem '+e+'"><div class="aesop-component-bar"><div class="aesop-component-controls"><div class="aesop-button aesop-button-delete">&nbsp;</div><div class="aesop-button aesop-button-edit aesop-scope-'+n[1]+'">&nbsp;</div><div class="aesop-button aesop-button-clipboard">&nbsp;</div></div><span class="mceNonEditable aesop-component-title unselectable aesop-'+n[1]+'-title">'+n[1]+'</span></div><div class="aesop-end">WcMgcq</div></div>'}return s}function a(e){return e.replace(/<div.*?class="[^"]+aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>|<div class="[^"]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,function(e){return n(e)})}function n(e){var o=/<div.*?class="[^"]+aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?aesop-component-content[^>]*?>(.*?)<\/div>[\s]*?<\/div>/g,t=/<div class="[^"]+?aesop-component.*?aesop-sc="([^"]+)"[\s\S]*?WcMgcq<\/div><\/div>/g,a=o.exec(e);if(a){sc=window.decodeURIComponent(a[1]);var n=/\[[^\]]*\]([^\[]*)[^\]]*\]/,s=n.exec(sc);return sc=sc.replace(s[1],a[2])}return(a=t.exec(e))?sc=window.decodeURIComponent(a[1]):e}function s(e){var o=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]([^\[\]]+)\[\/aesop_[a-zA-Z]+]/g,t=/\[aesop_([a-zA-Z]+)\s([^\[\]]*)]/g,a=/<br data-mce-bogus="1">/g,n=/([^\s]+)\s?/g,s=o.exec(e);if(!s&&(s=t.exec(e),!s))return match;var c=s[2].split(" ");return ai_map=[],c.forEach(function(e){e=e.split("="),attr_key=e[0],attr_value=e[1],attr_value=attr_value.slice(0,-1),ai_map[attr_key]=attr_value.substring(1)}),"undefined"!=typeof s[3]&&(ai_map.content=s[3].replace(a,"")),ai_map}function c(e){e.parentNode.removeChild(e)}function i(e){e.style.display="none"!=e.style.display?"none":"block"}function p(e){window.clipboardSource=e;var o=tinymce.activeEditor,t=o.dom.create("div",{"class":"clipboardControl"},'<div class="aesop-button aesop-button-paste">&nbsp;</div>');o.getBody().insertBefore(t,o.getBody().firstChild),window.clipboardControl=$(t)}function d(){var e=tinymce.activeEditor,o=e.dom.select(".clipboardControl");e.dom.remove(o),delete window.clipboard,delete window.clipboardSource,delete window.clipboardControl}function r(){var e=window.clipboardSource,o=tinymce.activeEditor;$(e).remove(),i(window.clipboard),o.execCommand("mceInsertRawHTML",!1,window.clipboard.outerHTML),d()}e.onClick.add(function(e,o){if(o.target.className.indexOf("aesop-button-delete")>-1){var t=confirm("Are you sure you want to delete this Aesop Component?");1==t&&o.target.parentNode.parentNode.parentNode.parentNode.removeChild(o.target.parentNode.parentNode.parentNode)}if(o.target.className.indexOf("aesop-button-edit")>-1){var n=/aesop-scope-([a-z]*)/,c=n.exec(o.target.className),d=o.target.parentNode.parentNode.parentNode,r=a(d.outerHTML);if(d.setAttribute("id","aesop-generator-editing"),c){$("body").toggleClass("modal-open"),$("#aesop-generator-wrap").toggleClass("aesop-generator-open");var l=".dk_options li."+c[1]+" a";$(l).click();var v=s(r);for(var u in v)"content"==u?$("#aesop-generator-content").val(v[u]):$('#aesop-generator-settings [name="'+u+'"]').val(v[u])}}if(o.target.className.indexOf("aesop-button-clipboard")>-1){var d=o.target.parentNode.parentNode.parentNode;window.clipboard=d,i(d),p(d)}}),e.onKeyDown.add(function(e,o){if(13===o.keyCode&&!o.ctrlKey&&!o.shiftKey&&!o.altKey){var t=e.selection.getNode(),a=$(t).parents(".aesop-component");if($(t).parents(".aesop-component")[0]){o.preventDefault(),o.stopPropagation();var n=$("<p><br/></p>").insertAfter(a);n.uniqueId();var s=n.attr("id"),c=e.dom.select("#"+s)[0];e.selection.setCursorLocation(c)}}o.ctrlKey&&o.altKey&&13===o.keyCode&&(o.preventDefault(),o.stopPropagation(),"undefined"==typeof window.clipboard?console.log("clipboard is empty"):r())}),e.on("BeforeSetContent",function(e){e.content=o(e.content)}),e.on("PostProcess",function(e){e.get&&(e.content=a(e.content))})})}(window.jQuery);
//# sourceMappingURL=./plugin.min.map